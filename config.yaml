#==========================================
# @ConfigName ShellCrash æ­£åˆ™è‡ªåŠ¨åˆ†æµç‰ˆ
# @Optimization èŠ‚ç‚¹å†™æ­» + ç­–ç•¥ç»„æ­£åˆ™æŠ“å–
# @UpdateTime 2025-12-06
#==========================================

# --- åŸºç¡€è®¾ç½® ---
port: 7890
socks-port: 7891
allow-lan: true
mode: Rule
log-level: info
ipv6: false
external-controller: :9090

# --- å†…æ ¸ä¼˜åŒ– ---
tcp-concurrent: true
find-process-mode: strict

# --- è¿æ¥å¤ç”¨ ---
mux:
  enabled: false
  protocol: smux
  max-connections: 4

# --- DNS è®¾ç½® ---
dns:
  enable: true
  listen: :1053
  ipv6: false
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
    - "*.lan"
    - "*.localhost"
    - "stun.*"
    - "+.msftconnecttest.com"
    - "+.msftncsi.com"
  default-nameserver:
    - 223.5.5.5
    - 119.29.29.29
  nameserver:
    - https://doh.pub/dns-query
    - https://dns.alidns.com/dns-query
  fallback:
    - https://1.1.1.1/dns-query
    - https://8.8.8.8/dns-query
  fallback-filter:
    geoip: true
    ipcidr:
      - 240.0.0.0/4
  fallback-auto: true

# --- å—…æ¢è®¾ç½® ---
sniffer:
  enable: true
  parse-pure-ip: true
  sniff:
    tls:
      ports: [443, 8443]
    http:
      ports: [80, 8080-8880]
      override-destination: true

#=========================================================
# 1. ä»£ç†èŠ‚ç‚¹ (ä½ çš„ 20 ä¸ªèŠ‚ç‚¹)
#=========================================================
proxies:
  - {name: "ğŸ‡ºğŸ‡¸ ç¾å›½ US", server: 142.171.42.144, port: 80, type: vless, uuid: 5230d600-aa94-492f-90c9-42faf8c61f82, tls: true, skip-cert-verify: true, servername: tjdownload.pan.wo.cn, flow: xtls-rprx-vision, reality-opts: {public-key: 2V-dGLrGFI9y5Q4TjOjAI8jpnxbAnzn4U4k1SSI5REs, short-id: "ab00ab"}, client-fingerprint: chrome}
  - {name: "ğŸ‡¯ğŸ‡µ æ—¥æœ¬ ä¸­æ€§ å¹¿æ’­IP", server: 176.97.73.174, port: 53201, type: vmess, uuid: 3191e20e-6ebd-47d7-ad65-a20797e437ee, alterId: 0, cipher: auto, tls: false}
  - {name: "ğŸ‡­ğŸ‡° é¦™æ¸¯ vmess_auto", server: 154.36.175.227, port: 30454, type: vmess, uuid: 14fbbb99-c88a-41aa-8dcd-8f18c957fb5b, alterId: 0, cipher: auto, tls: false}
  - {name: "ğŸ‡»ğŸ‡³ è¶Šå—åŸç”ŸIP BP", server: 36.50.135.96, port: 30880, type: ss, cipher: aes-128-gcm, password: QwErTyUiOp}
  - {name: "ğŸ‡ºğŸ‡¸ ç¾å›½ æ´›æ‰çŸ¶ å®¶åº­IP", server: 216.167.127.32, port: 54376, type: ss, cipher: aes-256-gcm, password: 1Yf6gAhxhd}
  - {name: "ğŸ‡ºğŸ‡¸ ç¾å›½ ä¸­æ€§ 29Mbps", server: "185.92.181.153", port: 443, type: "vless", uuid: "bc51c17a-6400-43e1-ad04-bc4eb2c2b75a", tls: true, client-fingerprint: "chrome"}

#=========================================================
#=========================================================
# 2. ç­–ç•¥ç»„ (Proxy Groups)
# ğŸŸ¢ ä¼˜åŒ–ç‰ˆï¼šä½¿ç”¨ YAML é”šç‚¹ (&) å’Œ å¼•ç”¨ (*) ç»Ÿä¸€ç®¡ç†
#=========================================================
proxy-groups:
  # --- åœ°åŒºåˆ†ç»„ ---

  - {name: æ‰‹åŠ¨åˆ‡æ¢, type: url-test, include-all: true, interval: 600, tolerance: 50,  filter: "^(?!.*(DIRECT|REJECT)).*", icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/Static.png }
  - {name: è‡ªåŠ¨é€‰æ‹©, type: url-test, include-all: true, interval: 600, tolerance: 50,  filter: "^(?!.*(DIRECT|REJECT)).*", icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/Urltest.png }
  - {name: é¦™æ¸¯èŠ‚ç‚¹, type: url-test, include-all: true, interval: 600, tolerance: 50,  filter: "æ¸¯|HK|(?i)Hong", icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/HK.png }             
  - {name: æ—¥æœ¬èŠ‚ç‚¹, type: url-test, include-all: true, interval: 600, tolerance: 50,  filter: "æ—¥|ä¸œäº¬|JP|(?i)Japan", icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/JP.png }
  - {name: å°æ¹¾èŠ‚ç‚¹, type: url-test, include-all: true, interval: 600, tolerance: 50,  filter: "å°|æ¹¾|TW|(?i)Taiwan", icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/TW.png }
  - {name: ç¾å›½èŠ‚ç‚¹, type: url-test, include-all: true, interval: 600, tolerance: 50,  filter: "ç¾|US|(?i)States|American", icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/US.png }
  - {name: ç‹®åŸèŠ‚ç‚¹, type: url-test, include-all: true, interval: 600, tolerance: 50,  filter: "æ–°|å¡|SG|(?i)Singapore", icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/SG.png }


  


  # --- é¡¶å±‚åˆ†ç»„ (æ— éœ€ä¿®æ”¹ï¼Œå› ä¸ºå¼•ç”¨çš„æ˜¯ç»„å) ---
  - name: "å…¨çƒåŠ é€Ÿ"
    type: select
    proxies:
      - "è‡ªåŠ¨é€‰æ‹©"
      - "æ‰‹åŠ¨åˆ‡æ¢"
      - "é¦™æ¸¯èŠ‚ç‚¹"
      - "æ—¥æœ¬èŠ‚ç‚¹"
      - "å°æ¹¾èŠ‚ç‚¹"
      - "ç¾å›½èŠ‚ç‚¹"
      - "ç‹®åŸèŠ‚ç‚¹"
      - "DIRECT"
    icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/Global.png

  # --- åº”ç”¨åˆ†ç»„ (æ— éœ€ä¿®æ”¹) ---
  - name: "è‹¹æœæœåŠ¡"
    type: select
    proxies: ["DIRECT", "å…¨çƒåŠ é€Ÿ", "æ‰‹åŠ¨åˆ‡æ¢"]
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Apple.png

  - name: "å“”å“©å“”å“©"
    type: select
    proxies: ["DIRECT", "é¦™æ¸¯èŠ‚ç‚¹", "å°æ¹¾èŠ‚ç‚¹"]
    icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/bilibili.png

  - name: "EmbyæœåŠ¡"
    type: select
    proxies: ["å…¨çƒåŠ é€Ÿ", "æ‰‹åŠ¨åˆ‡æ¢", "DIRECT"]
    icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/Emby.png

  - name: "ä¸‹è½½åŠ é€Ÿ"
    type: select
    proxies:
      - "DIRECT"
      - "å…¨çƒåŠ é€Ÿ"
      - "ç¾å›½èŠ‚ç‚¹"
      - "æ‰‹åŠ¨åˆ‡æ¢"
    icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Download.png

  - name: "OpenAi"
    type: select
    proxies:
      - "ç¾å›½èŠ‚ç‚¹"
      - "æ—¥æœ¬èŠ‚ç‚¹"
      - "ç‹®åŸèŠ‚ç‚¹"
      - "å…¨çƒåŠ é€Ÿ"
      - "æ‰‹åŠ¨åˆ‡æ¢"
    icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/OpenAI.png

  - name: "å›½é™…åª’ä½“"
    type: select
    proxies:
      - "å…¨çƒåŠ é€Ÿ"
      - "æ‰‹åŠ¨åˆ‡æ¢"
      - "é¦™æ¸¯èŠ‚ç‚¹"
      - "æ—¥æœ¬èŠ‚ç‚¹"
      - "å°æ¹¾èŠ‚ç‚¹"
      - "ç¾å›½èŠ‚ç‚¹"
      - "ç‹®åŸèŠ‚ç‚¹"
    icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/Streaming.png
  
  - name: TikTok
    type: select
    proxies:
      - "å…¨çƒåŠ é€Ÿ"
      - "æ‰‹åŠ¨åˆ‡æ¢"
      - "é¦™æ¸¯èŠ‚ç‚¹"
      - "æ—¥æœ¬èŠ‚ç‚¹"
      - "å°æ¹¾èŠ‚ç‚¹"
      - "ç¾å›½èŠ‚ç‚¹"
      - "ç‹®åŸèŠ‚ç‚¹"
    icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/TikTok.png
    
  - name: "è°·æ­ŒæœåŠ¡"
    type: select
    proxies: ["å…¨çƒåŠ é€Ÿ", "æ‰‹åŠ¨åˆ‡æ¢"]
    icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/Google.png

  - name: "ç”µæŠ¥æ¶ˆæ¯"
    type: select
    proxies: ["å…¨çƒåŠ é€Ÿ", "æ‰‹åŠ¨åˆ‡æ¢", "é¦™æ¸¯èŠ‚ç‚¹", "æ—¥æœ¬èŠ‚ç‚¹", "ç¾å›½èŠ‚ç‚¹"]
    icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/Telegram.png

  - name: "æ¨ç‰¹æœåŠ¡"
    type: select
    proxies: ["å…¨çƒåŠ é€Ÿ", "æ‰‹åŠ¨åˆ‡æ¢", "ç¾å›½èŠ‚ç‚¹", "æ—¥æœ¬èŠ‚ç‚¹"]
    icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/Twitter.png

  - name: "æ¸¸æˆå¹³å°"
    type: select
    proxies:
      - "DIRECT"
      - "é¦™æ¸¯èŠ‚ç‚¹"
      - "æ—¥æœ¬èŠ‚ç‚¹"
      - "å…¨çƒåŠ é€Ÿ"
      - "æ‰‹åŠ¨åˆ‡æ¢"
    icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/GAME.png

  - name: "AdBlock"
    type: select
    proxies: ["REJECT", "DIRECT"]
    icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/Adblock.png

  # --- å…œåº•åˆ†ç»„ ---
  - name: "å…œåº•åˆ†æµ"
    type: select
    proxies: ["å…¨çƒåŠ é€Ÿ", "æ‰‹åŠ¨åˆ‡æ¢", "DIRECT"]
    icon: https://raw.githubusercontent.com/Orz-3/mini/master/Color/Final.png


#=========================================================
# 3. è§„åˆ™é›†ä¸åˆ†æµè§„åˆ™
#=========================================================
rule-providers:
  AdBlock: {behavior: domain, interval: 86400, format: text, type: http, url: https://raw.githubusercontent.com/Cats-Team/AdRules/main/adrules_domainset.txt , path: ./ruleset/anti-ad-clash.txt}
  OpenAi: {behavior: classical, interval: 86400, format: yaml, type: http, url: https://gist.githubusercontent.com/ddgksf2013/cb4121e8b5c5d865cc949cb8120320c4/raw/Ai.yaml , path: ./ruleset/OpenAi.yaml}
  Emby: {behavior: classical, interval: 86400, format: yaml, type: http, url: https://raw.githubusercontent.com/ddgksf2013/Filter/master/Emby.yaml , path: ./ruleset/Emby.yaml}
  BiliBili: {behavior: classical, interval: 86400, format: yaml, type: http, url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/BiliBili/BiliBili.yaml , path: ./ruleset/BiliBili.yaml}
  Bahamut: {behavior: classical, interval: 86400, format: yaml, type: http, url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Bahamut/Bahamut.yaml , path: ./ruleset/Bahamut.yaml}
  GlobalMedia: {behavior: classical, interval: 86400, format: yaml, type: http, url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/GlobalMedia/GlobalMedia_Classical.yaml , path: ./ruleset/GlobalMedia.yaml}
  Apple: {behavior: classical, interval: 86400, format: yaml, type: http, url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Apple/Apple_Classical.yaml , path: ./ruleset/Apple.yaml}
  Github: {behavior: classical, interval: 86400, format: yaml, type: http, url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/GitHub/GitHub.yaml , path: ./ruleset/Github.yaml}
  Microsoft: {behavior: classical, interval: 86400, format: yaml, type: http, url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Microsoft/Microsoft.yaml , path: ./ruleset/Microsoft.yaml}
  Google: {behavior: classical, interval: 86400, format: yaml, type: http, url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Google/Google.yaml , path: ./ruleset/Google.yaml}
  Telegram: {behavior: classical, interval: 86400, format: yaml, type: http, url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Telegram/Telegram.yaml , path: ./ruleset/Telegram.yaml}
  Twitter: {behavior: classical, interval: 86400, format: yaml, type: http, url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Twitter/Twitter.yaml , path: ./ruleset/Twitter.yaml}
  Game: {behavior: classical, interval: 86400, format: yaml, type: http, url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Game/Game.yaml , path: ./ruleset/Game.yaml}
  ProxyLite: {behavior: classical, interval: 86400, format: yaml, type: http, url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/ProxyLite/ProxyLite.yaml , path: ./ruleset/ProxyLite.yaml}
  Direct: {behavior: classical, interval: 86400, format: yaml, type: http, url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Direct/Direct.yaml , path: ./ruleset/Direct.yaml}
  Lan: {behavior: classical, interval: 86400, format: yaml, type: http, url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Lan/Lan.yaml , path: ./ruleset/Lan.yaml}
  Download: {behavior: classical, interval: 86400, format: yaml, type: http, url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Download/Download.yaml , path: ./ruleset/Download.yaml}
  TikTok: {behavior: classical, interval: 86400, format: yaml, type: http, url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/TikTok/TikTok.yaml , path: ./ruleset/TikTok.yaml}    
  ChinaIP: {behavior: ipcidr, interval: 86400, format: yaml, type: http, url: https://raw.githubusercontent.com/soffchen/GeoIP2-CN/release/clash-rule-provider.yml , path: ./ruleset/ChinaIP.yaml}

rules:
  # 1. å¹¿å‘Šæ‹¦æˆª (ä¿æŒç¬¬ä¸€)
  - RULE-SET,AdBlock,AdBlock

  # =========================================
  # ğŸ”´ é‡ç‚¹ï¼šæŠŠç‰¹æ®ŠæœåŠ¡è§„åˆ™æåˆ° ç›´è¿è§„åˆ™ ä¹‹å‰
  # =========================================
  
  # 3. AI æœåŠ¡ä¼˜åŒ– (å»ºè®®ä¹Ÿæ”¾å‰é¢)
  - RULE-SET,OpenAi,OpenAi
  - DOMAIN-SUFFIX,copilot.microsoft.com,OpenAi
  # ... (å…¶ä»– AI è§„åˆ™ä¿æŒä¸å˜)

  # 4. åª’ä½“æœåŠ¡ (å¿…é¡»æä¸Šæ¥ï¼)
  - RULE-SET,TikTok,TikTok        <-- ç§»åˆ°è¿™é‡Œï¼ç¡®ä¿ TikTok æµé‡ä¼˜å…ˆåŒ¹é…ä»£ç†
  - RULE-SET,Emby,EmbyæœåŠ¡
  - RULE-SET,BiliBili,å“”å“©å“”å“©
  - RULE-SET,Bahamut,å°æ¹¾èŠ‚ç‚¹
  - RULE-SET,GlobalMedia,å›½é™…åª’ä½“

  # =========================================
  # 2. ç›´è¿è§„åˆ™ (ä¸‹æ”¾)
  # =========================================
  - RULE-SET,ChinaIP,DIRECT
  - RULE-SET,Direct,DIRECT
  - RULE-SET,Lan,DIRECT
  - GEOIP,CN,DIRECT
  - GEOIP,PRIVATE,DIRECT

  # 5. å¸¸ç”¨æœåŠ¡
  - RULE-SET,Apple,è‹¹æœæœåŠ¡
  - RULE-SET,Github,å…¨çƒåŠ é€Ÿ
  - DOMAIN-SUFFIX,github.io,å…¨çƒåŠ é€Ÿ
  - DOMAIN-SUFFIX,githubassets.com,å…¨çƒåŠ é€Ÿ
  - RULE-SET,Microsoft,DIRECT
  - DOMAIN-SUFFIX,msn.com,å…¨çƒåŠ é€Ÿ
  - RULE-SET,Google,è°·æ­ŒæœåŠ¡
  - RULE-SET,Telegram,ç”µæŠ¥æ¶ˆæ¯
  - RULE-SET,Twitter,æ¨ç‰¹æœåŠ¡
  - RULE-SET,Game,æ¸¸æˆå¹³å°
  - RULE-SET,ProxyLite,å…¨çƒåŠ é€Ÿ

  # 6. ä¸‹è½½æµé‡
  - RULE-SET,Download,ä¸‹è½½åŠ é€Ÿ

  # 7. å¹¿å‘Šå…³é”®è¯è¡¥å……
  - DOMAIN-KEYWORD,adservice,AdBlock

  # 8. æœ€ç»ˆå…œåº•
  - MATCH,å…œåº•åˆ†æµ
